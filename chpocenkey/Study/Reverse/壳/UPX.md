## 简介

UPX （the Ultimate Packer for eXecutables） 是一款先进的可执行程序文件压缩器，也是一个著名的压缩壳，主要功能是压缩 PE 文件，有时候也可能被病毒用于免杀

UPX 壳是一种保护程序，其主要用途为

- 让正规文件被保护起来，不容易被修改和破解
- 让文件压缩变小
- 保护杀毒软件安装程序，使之不受病毒侵害
- 木马、病毒的保护外壳，使之难以被识别

UPX 对于可执行程序资源压缩，是保护文件的常用手段，俗称加壳

加壳过的程序可以直接运行，但是不能查看源代码，需要经过脱壳才可以查看源代码
## 技术原理

UPX 加壳其实是利用特殊算法，对 PE 文件里的资源进行压缩，实现类似 ZIP 的效果，但是这个要锁之后的文件可以独立运行，解压过程在内存中完成，在用户角度完全隐藏

解压原理是加壳工具在文件头里加了一段指令，告诉 CPU，如何解压自己

## 应用范围
### 压缩文件

使用 UPX 压缩过的可执行文件体积缩小 50% - 70%，这样减少了磁盘占用空间、网络上传下载的时间和其他分布以及存储费用

通过 UPX 压缩过的程序和程序库完全没有功能损失，和压缩前一样可以正常地运行，支持的大多数格式程序，没有运行时间或内存的不利后果

### 保护文件

程序为了反跟踪，防止算法程序被静态分析，就需要加壳

使用加壳软件加密代码和数据，就可以保护程序数据的完整性，防止被程序分析和修改

## 软件使用

UPX 在 [Github](https://github.com/upx/upx/releases/) 上已开源，同时也有自己的 [官网](https://upx.github.io/)

命令行打开后，使用 `-h` 参数可以查看使用方法

```
upx -h
```

核心用法为 **加壳** 和 **脱壳** 

```
upx sample.exe // 加壳
upx -d sample.exe // 脱壳
```