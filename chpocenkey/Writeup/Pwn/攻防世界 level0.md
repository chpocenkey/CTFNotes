1. 直接用 gdb 调试![[屏幕截图 2024-04-12 215837.png]]
2. 先用 checksec 查看一下调用了哪些保护![[屏幕截图 2024-04-12 215822.png]]发现只开了 NX 保护
3. `start` 进入 `main` 函数，用汇编语言观察（可以直接用 IDA，但是想要锻炼一下直接看汇编的能力，刚开始是 IDA 和 gdb 对照地看）![[Pasted image 20240412220406.png]]`main` 函数中先调用 `write` 函数，输出响应信息，然后调用 `0x4005a6` 处函数。`0x4005a6` 处函数调用 `read` 函数，且 `read` 的数量为 `0x200`，但是因为 `lea rax, [rbp-0x80]`， 所以 `read` 实际接收到的数量为 `0x88`，剩下的都会作为栈溢出，能被我们利用。想要构成栈溢出，需要填满 `0x80+0x8` 个字节，接下来的内容会覆盖到 `rip` 上，作为接下来的函数地址被调用
4. 发现关键函数 `system`，用 `x\s 0x400684`查看它的参数 `0x400684` 的字符串形式![[Pasted image 20240412220423.png]]发现是字符串 `/bin/sh`，即该处直接调用了函数 `system("/bin/sh")`，只需要将调用该函数的函数地址 `0x400596` 覆盖到 `rip` 上即可
5. 编写脚本
```
from pwn import *
r = remote("61.147.171.105", 54657)
p1 = b'a' * 0x88 + p64(0x400596)
r.sendline(p1)
r.interactive()
```
6. 调试通过，获得 `flag`![[Pasted image 20240412222149.png]]